# Local dev server
python manage.py runserver --settings=config.settings.dev

# Migrations
python manage.py makemigrations --settings=config.settings.base
python manage.py migrate --settings=config.settings.base

# Into container
docker compose exec web python manage.py makemigrations posts

docker compose exec web python manage.py makemigrations
docker compose exec web python manage.py migrate

docker-compose exec web bash

# API
http://127.0.0.1:8000/api/docs/

# Fixtures
docker compose exec web python manage.py loaddata fixtures/users_fixture.json
docker compose exec web python manage.py loaddata fixtures/posts_fixture.json

docker-compose exec web python manage.py shell -c "from django.contrib.auth import get_user_model; from allauth.account.models import EmailAddress; User=get_user_model(); names=['admin','user1','user2','user3','user4','user5'];
import sys
for n in names:
    try:
        u=User.objects.get(username=n)
        u.set_password('123456')
        u.save()
        EmailAddress.objects.update_or_create(user=u, email=u.email, defaults={'verified': True, 'primary': True})
        print('OK:', n)
    except Exception as e:
        print('SKIP', n, e, file=sys.stderr)"


