{% load static %}

{% if user.is_authenticated and user != profile_user %}
<button
  type="button"
  class="btn subscribe-btn {% if is_subscribed %}subscribed{% endif %}"
  aria-pressed="{% if is_subscribed %}true{% else %}false{% endif %}"
  aria-label="{% if is_subscribed %}Unfollow {{ profile_user.username }}{% else %}Follow {{ profile_user.username }}{% endif %}"
  data-toggle-url="{% url 'subscriptions:toggle' profile_user.pk %}"
  data-user-id="{{ profile_user.pk }}"
  data-followers-count="{{ followers_count|default:0 }}"
>
  <span class="fp-icon"><i class="bi {% if is_subscribed %}bi-check-lg{% else %}bi-person-plus{% endif %}"></i></span>
  <span class="subscribe-label">{% if is_subscribed %}You're following{% else %}Follow{% endif %}</span>
  <span class="fp-sep" aria-hidden="true">Â·</span>
  <span class="followers-count fp-count">{{ followers_count|default:0 }}</span>
</button>

{% elif not user.is_authenticated %}
  <a class="btn btn-sm btn-outline-primary" href="{% url 'account_login' %}?next={{ request.path }}">Follow</a>
{% endif %}

{% block extra_css %}
<style>

.subscribe-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.55rem;
  padding: 0.32rem 0.65rem;
  border-radius: 999px;
  font-weight: 600;
  font-size: 0.95rem;
  line-height: 1;
  border: 1px solid transparent;
  cursor: pointer;
  transition: transform .12s ease, box-shadow .12s ease, background-color .18s ease, color .12s ease;
  -webkit-tap-highlight-color: transparent;
  user-select: none;
  background: linear-gradient(90deg, #2563eb 0%, #7c3aed 100%);
  color: #fff;
  box-shadow: 0 6px 18px rgba(37,99,235,0.14);
  padding-left: 0.7rem;
  padding-right: 0.7rem;
}

.subscribe-btn .fp-icon { display: inline-flex; align-items:center; }
.subscribe-btn .fp-sep { opacity: 0.9; color: rgba(255,255,255,0.85); margin: 0 0.1rem; }
.subscribe-btn .fp-count { font-weight: 700; opacity: 0.95; }

.subscribe-btn.subscribed {
  background: transparent;
  color: var(--bs-primary, #2563eb);
  border-color: rgba(37,99,235,0.12);
  box-shadow: none;
}

.subscribe-btn:hover { transform: translateY(-2px); }
.subscribe-btn:active { transform: translateY(0); }
.subscribe-btn:focus-visible {
  outline: 3px solid rgba(37,99,235,0.14);
  outline-offset: 2px;
}

@media (max-width: 576px) {
  .subscribe-btn { font-size: 0.88rem; padding: 0.28rem 0.5rem; gap: .4rem; }
}
</style>
{% endblock %}
